---
title: "Final Project"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(leaflet)
library(DT)
library(plotly)
library(flexdashboard)

#try fuzzyjoint package

#Goal: to assess the diversity ratio among students across all the Higher Education institutions in Colorado

## data manipulation
# read data and filter just for Colorado

diversity_school <- read.csv("diversity_school.csv")

diversity_school <- diversity_school %>% 
  filter(state == "Colorado") 

#Count amount of schools in Colorado
diversity_school %>% 
  select(name) %>%
  distinct() %>%
  count()

#top ten universities in CO (based on enrollment)
top10_co_schools <- diversity_school %>%
  select(name, total_enrollment) %>%
  distinct() %>%
  head(n= 10)




##parameterized Rmd (see params.Rmd)
#exercise 2----
##leaflet for `encounter_length`
pal <- colorQuantile("YlOrRd", NULL, n = 8)
leaflet(<dataset>) %>% 
  addTiles() %>%
  addCircleMarkers(color = ~pal(<columnt hat I actually want to show>))
##plotly for `shape`
#filter to 3 shapes
ufo_sightings_shapes <- ufo_sightings %>% 
  filter(ufo_shape %in% c("circle", "fireball", "oval"))
#plot
p <- ggplot(data = ufo_sightings_shapes, aes(x = ufo_shape)) +
  geom_bar(position = "dodge")
ggplotly(p)
#DT

 interactive data table:
   
datatable(ufo_sightings_us, options = list(pageLength = 5))
ufo_sightings_co <- ufo_sightings %>% 
  mutate(date_time = mdy_hm(date_time),
         sighting_year = year(date_time)) %>% 
  filter(state == 'co')
```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
pal <- colorQuantile("YlOrRd", NULL, n = 8)
leaflet() %>% 
  addTiles() %>% 
  fitBounds(-102.03,37,-109.03, 41) %>% 
  addTiles() %>% 
  addCircleMarkers(ufo_sightings_co$longitude, 
                   ufo_sightings_co$latitude, 
                   color = ufo_sightings_co$encounter_length, 
                   radius = 5, 
                   fill = T,
                   fillOpacity = 0.2,
                   opacity = 0.6,
                   popup = paste(ufo_sightings_co$city_area,
                                 ufo_sightings_co$sighting_year, 
                                 sep = ",")) 
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
ufo_sightings_co <-  ufo_sightings_co %>%
  group_by(sighting_year) %>%
  summarize(n_year = n()) %>%
  ungroup()
ggplot(ufo_sightings_co, aes(x = sighting_year, y = n_year)) +
  geom_line() +
  ggthemes::theme_few() +
  labs(x = "Year", y = "Sighting Count in CO", title = "UFO Sightings in CO per Year")
```

### Chart C

```{r}
ufo_sightings_co <-  ufo_sightings_co %>%
  group_by(sighting_year) %>%
  summarize(n_year = n()) %>%
  ungroup()
ufo_sightings_co %>%
datatable()
```
